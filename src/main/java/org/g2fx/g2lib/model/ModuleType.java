package org.g2fx.g2lib.model;

import com.google.common.collect.Streams;

import java.util.*;
import java.util.stream.IntStream;
import java.util.stream.Stream;

import static org.g2fx.g2lib.model.ConnColor.*;
import static org.g2fx.g2lib.model.Connector.in;
import static org.g2fx.g2lib.model.Connector.out;
import static org.g2fx.g2lib.model.Visual.VisualType;
import static org.g2fx.g2lib.model.Visual.VisualType.*;

public enum ModuleType {
    M_Keyboard
    (1, "Keyboard", 2,
     ModPage.InOut.ix(5),
     List.of(),
     List.of(out("Pitch",Blue,2,1),
             out("Gate",Yellow,5,1),
             out("Lin",Blue,9,1),
             out("Release",Blue,12,1),
             out("Note",Blue,15,1),
             out("Exp",Blue,19,1)),
     List.of(),
     List.of()),
    M_4_Out
    (3, "4 outputs", 2,
     ModPage.InOut.ix(1),
     List.of(in("In1",Red,13,1),
             in("In2",Red,15,1),
             in("In3",Red,17,1),
             in("In4",Red,19,1)),
     List.of(),
     List.of(ModParam.Dst_2.mk("Destination"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Pad_1.mk("Pad")),
     List.of(),
            meters(namedRange("In", 4))),
    M_2_Out
    (4, "2 outputs", 2,
     ModPage.InOut.ix(0),
     List.of(in("InL",Red,17,1),
             in("InR",Red,19,1)),
     List.of(),
     List.of(ModParam.Dst_1.mk("Destination"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Pad_1.mk("Pad")),
     List.of(),
            meters("L","R")),
    M_Invert
    (5, "Logic Inverter", 2,
     ModPage.Logic.ix(1),
     List.of(in("In1",Yellow_orange,7,1),
             in("In2",Yellow_orange,15,1)),
     List.of(out("Out1",Yellow_orange,11,1),
             out("Out2",Yellow_orange,19,1)),
     List.of(),
     List.of(),
            visuals(led("Inv1"),led("Inv2"))), // grouped singles
    M_OscB
    (7, "Osc B", 5,
     ModPage.Osc.ix(1),
     List.of(in("Pitch",Blue_red,0,3),
             in("PitchVar",Blue_red,0,4),
             in("Sync",Red,0,1),
             in("FmMod",Red,9,4),
             in("ShapeMod",Red,14,4)),
     List.of(out("Out",Red,19,4)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("FmAmount"),
             ModParam.PW.mk("Shape"),
             ModParam.Level_100.mk("ShapeMod"),
             ModParam.OscBWaveform.mk("Waveform"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.FmLinTrk.mk("FmMode")),
     List.of()),
    M_OscShpB
    (8, "Osc Shape B", 4,
     ModPage.Osc.ix(6),
     List.of(in("Pitch",Blue_red,0,2),
             in("PitchVar",Blue_red,0,3),
             in("Sync",Red,0,1),
             in("FmMod",Red,10,3),
             in("ShapeMod",Red,15,3)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("FmAmount"),
             ModParam.PW.mk("Shape"),
             ModParam.Level_100.mk("ShapeMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.FmLinTrk.mk("FmMode")),
     List.of(ModParam.OscWaveform_3.mk("Waveform"))),
    M_OscC
    (9, "Osc C", 3,
     ModPage.Osc.ix(2),
     List.of(in("PitchVar",Blue_red,0,2),
             in("Sync",Red,12,2),
             in("FmMod",Red,14,2),
             in("Pitch",Blue_red,0,1)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("FmAmount"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.FmLinTrk.mk("FmMode"),
             ModParam.Level_100.mk("PitchMod")),
     List.of(ModParam.OscWaveform_2.mk("Waveform"))),
    M_Reverb
    (12, "reverb", 3,
     ModPage.FX.ix(7),
     List.of(in("InL",Red,17,0),
             in("InR",Red,19,0)),
     List.of(out("OutL",Red,17,2),
             out("OutR",Red,19,2)),
     List.of(ModParam.ReverbTime.mk("Time"),
             ModParam.Level_100.mk("Brightness"),
             ModParam.Level_100.mk("DryWet"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.RoomType.mk("RoomType"))),
    M_OscString
    (13, "Osc String", 3,
     ModPage.Osc.ix(13),
     List.of(in("In",Red,19,0),
             in("Pitch",Blue,0,1),
             in("PitchVar",Blue,0,2)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("Decay"),
             ModParam.Level_100.mk("Moisture"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Sw8_1
    (15, "Switch 8-1", 4,
     ModPage.Switch.ix(5),
     List.of(in("In1",Blue_red,6,0),
             in("In2",Blue_red,7,1),
             in("In3",Blue_red,9,0),
             in("In4",Blue_red,11,1),
             in("In5",Blue_red,13,0),
             in("In6",Blue_red,14,1),
             in("In7",Blue_red,15,0),
             in("In8",Blue_red,18,1)),
     List.of(out("Out",Blue_red,19,3),
             out("Control",Blue,9,3)),
     List.of(ModParam.Sw_3.mk("Sel")
             .label("In 1","In 2","In 3","In 4","In 5","In 6","In 7","In 8")),
     List.of()),
    M_ValSw1_2
    (17, "Value Switch 1-2", 2,
     ModPage.Switch.ix(11),
     List.of(in("Input",Blue_red,14,2),
             in("Ctrl",Blue_red,0,2)),
     List.of(out("OutOn",Blue_red,16,2),
             out("OutOff",Blue_red,19,2)),
     List.of(ModParam.ValSwVal.mk("Val")
             .label("Out 1","Out 2")),
     List.of(),
            led()),
    M_X_Fade
    (18, "Cross Fader", 2,
     ModPage.Mixer.ix(13),
     List.of(in("In1",Blue_red,14,2),
             in("In2",Blue_red,16,2),
             in("Mod",Blue_red,6,2)),
     List.of(out("Out",Blue_red,19,2)),
     List.of(ModParam.Level_100.mk("MixMod"),
             ModParam.Bipolar_127.mk("Mix"),
             ModParam.LogLin.mk("LogLin")),
     List.of()),
    M_Mix4_1B
    (19, "Mixer 4-1 B", 2,
     ModPage.Mixer.ix(5),
     List.of(in("In1",Blue_red,5,1),
             in("In2",Blue_red,8,1),
             in("In3",Blue_red,12,1),
             in("In4",Blue_red,14,1),
             in("Chain",Blue_red,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.MixLevel.mk("Lev3"),
             ModParam.MixLevel.mk("Lev4"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of(),
            meter()),
    M_EnvADSR
    (20, "Envelop ADSR", 4,
     ModPage.Env.ix(0),
     List.of(in("In",Blue_red,19,0),
             in("Gate",Yellow,0,2),
             in("AM",Blue,0,3)),
     List.of(out("Env",Blue,18,3),
             out("Out",Blue_red,19,3)),
     List.of(ModParam.EnvShape_3.mk("Shape"),
             ModParam.EnvTime.mk("Attack"),
             ModParam.EnvTime.mk("Decay"),
             ModParam.EnvLevel.mk("Sustain"),
             ModParam.EnvTime.mk("Release"),
             ModParam.PosNegInvBipInv.mk("OutputType"),
             ModParam.OffOn.mk("KB"),
             ModParam.EnvNR.mk("NR")),
     List.of(),
            led("Gate")),
    M_Mux1_8
    (21, "Multiplexer 1-8", 2,
     ModPage.Switch.ix(14),
     List.of(in("In",Blue_red,6,1),
             in("Ctrl",Blue,0,1)),
     List.of(out("Out1",Blue_red,7,1),
             out("Out2",Blue_red,9,1),
             out("Out3",Blue_red,11,1),
             out("Out4",Blue_red,12,1),
             out("Out5",Blue_red,14,1),
             out("Out6",Blue_red,16,1),
             out("Out7",Blue_red,18,1),
             out("Out8",Blue_red,19,1)),
     List.of(),
     List.of(),
            ledgroup(Visual.LedGroupType.Radio, 8)), // TODO yaml has 7
    M_PartQuant
    (22, "Partial Quantizer", 2,
     ModPage.Note.ix(2),
     List.of(in("In",Blue,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.PartialRange.mk("Range")),
     List.of()),
    M_ModADSR
    (23, "Envelope Modulation ADSR", 5,
     ModPage.Env.ix(8),
     List.of(in("Gate",Yellow,0,4),
             in("AttackMod",Blue,2,4),
             in("DecayMod",Blue,5,4),
             in("SustainMod",Blue,8,4),
             in("ReleaseMod",Blue,11,4),
             in("In",Blue_red,19,0),
             in("AM",Blue,0,4)),
     List.of(out("Env",Blue,19,4),
             out("Out",Blue_red,17,4)),
     List.of(ModParam.EnvTime.mk("Attack"),
             ModParam.EnvTime.mk("Decay"),
             ModParam.EnvLevel.mk("Sustain"),
             ModParam.EnvTime.mk("Release"),
             ModParam.Level_100.mk("AttackMod"),
             ModParam.Level_100.mk("DecayMod"),
             ModParam.Level_100.mk("SustainMod"),
             ModParam.Level_100.mk("ReleaseMod"),
             ModParam.PosNegInvBipInv.mk("OutputType"),
             ModParam.OffOn.mk("KB")),
     List.of(),
            led("Gate")),
    M_LfoC
    (24, "LFO C", 2,
     ModPage.LFO.ix(2),
     List.of(in("Rate",Blue,0,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.LfoRate_3.mk("Rate"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.OutTypeLfo.mk("OutputType"),
             ModParam.LfoRange_3.mk("Range"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.LfoWaveform_1.mk("Waveform")),
            led()),
    M_LfoShpA
    (25, "LFO Shape A", 5,
     ModPage.LFO.ix(3),
     List.of(in("Rate",Blue,1,4),
             in("RateVar",Blue,2,4),
             in("Rst",Blue,0,1),
             in("ShapeMod",Blue,9,4),
             in("PhaseMod",Blue,12,4),
             in("Dir",Blue,1,1)),
     List.of(out("Out",Blue,19,4),
             out("Snc",Blue,0,4)),
     List.of(ModParam.LfoRate_4.mk("Rate"),
             ModParam.LfoRange_4.mk("Range"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.Level_100.mk("RateMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.LfoShpAPW.mk("Shape"),
             ModParam.Level_100.mk("PhaseMod"),
             ModParam.Phase.mk("Phase"),
             ModParam.Level_100.mk("ShapeMod"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.OutTypeLfo.mk("OutputType"),
             ModParam.LfoShpA__Waveform.mk("Waveform")),
     List.of(),
            led()),
    M_LfoA
    (26, "LFO A", 3,
     ModPage.LFO.ix(0),
     List.of(in("Rate",Blue,0,1),
             in("RateVar",Blue,0,2)),
     List.of(out("Out",Blue,19,2)),
     List.of(ModParam.LfoRate_3.mk("Rate"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.Level_100.mk("RateMod"),
             ModParam.LfoA_Waveform.mk("Waveform"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.OutTypeLfo.mk("OutputType"),
             ModParam.LfoRange_3.mk("Range")),
     List.of(),
            led()),
    M_OscMaster
    (27, "Osc Master", 3,
     ModPage.Osc.ix(16),
     List.of(in("Pitch",Blue_red,0,1),
             in("PitchVar",Blue_red,0,2)),
     List.of(out("Out",Blue_red,19,2)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.FreqMode_2.mk("FreqMode"),
             ModParam.Level_100.mk("PitchMod")),
     List.of()),
    M_Saturate
    (28, "Saturate", 2,
     ModPage.Shaper.ix(2),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,8,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("Amount"),
             ModParam.Level_100.mk("AmountMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.SaturateCurve.mk("Curve")),
     List.of()),
    M_MetNoise
    (29, "Metallic Noise Oscillator", 2,
     ModPage.Osc.ix(10),
     List.of(in("FreqMod",Blue_red,4,1),
             in("ColorMod",Blue_red,11,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.Level_100.mk("Color"),
             ModParam.Level_100.mk("Freq"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("FreqMod"),
             ModParam.Level_100.mk("ColorMod")),
     List.of()),
    M_Device
    (30, "Device", 3,
     ModPage.InOut.ix(7),
     List.of(),
     List.of(out("Wheel",Blue,0,2),
             out("AftTouch",Blue,3,2),
             out("ControlPedal",Blue,6,2),
             out("SustainPedal",Yellow,10,2),
             out("PitchStick",Blue,13,2),
             out("GlobalWheel1",Blue,16,2),
             out("GlobalWheel2",Blue,19,2)),
     List.of(),
     List.of()),
    M_Noise
    (31, "Noise", 2,
     ModPage.Osc.ix(9),
     List.of(),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.NoiseColor.mk("Color"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Eq2Band
    (32, "Eq 2 Band", 3,
     ModPage.Filter.ix(12),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.EqdB.mk("LoSlope"),
             ModParam.EqdB.mk("HiSlope"),
             ModParam.Level_100.mk("Level"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.EqLoFreq.mk("LoFreq"),
             ModParam.EqHiFreq.mk("HiFreq")),
     List.of(),
            meter()),
    M_Eq3Band
    (33, "Eq 3 Band", 4,
     ModPage.Filter.ix(13),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.EqdB.mk("LoSlope"),
             ModParam.EqdB.mk("MidGain"),
             ModParam.EqMidFreq.mk("MidFreq"),
             ModParam.EqdB.mk("HiSlope"),
             ModParam.Level_100.mk("Level"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.EqLoFreq.mk("LoFreq"),
             ModParam.EqHiFreq.mk("HiFreq")),
     List.of(),
            meter()),
    M_ShpExp
    (34, "Shape Exp", 2,
     ModPage.Shaper.ix(3),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,8,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("Amount"),
             ModParam.Level_100.mk("AmountMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.ShpExpCurve.mk("Curve")),
     List.of()),
    M_SwOnOffM
    (36, "Switch On/Off Momentary", 2,
     ModPage.Switch.ix(0),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.OffOn.mk("On").label("On")),
     List.of()),
    M_Pulse
    (38, "Pulse", 2,
     ModPage.Logic.ix(4),
     List.of(in("In",Yellow_orange,15,0),
             in("Time",Blue_red,4,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(ModParam.LogicTime.mk("Time"),
             ModParam.Level_100.mk("TimeMod"),
             ModParam.LogicRange.mk("Range")),
     List.of(ModParam.PulseMode.mk("Mode")),
            led()),
    M_Mix8_1B
    (40, "Mixer 8-1 B", 4,
     ModPage.Mixer.ix(9),
     List.of(in("In1",Blue_red,3,1),
             in("In2",Blue_red,5,1),
             in("In3",Blue_red,7,1),
             in("In4",Blue_red,9,1),
             in("In5",Blue_red,11,1),
             in("In6",Blue_red,13,1),
             in("In7",Blue_red,15,1),
             in("In8",Blue_red,17,1),
             in("Chain",Blue_red,19,0)),
     List.of(out("Out",Blue_red,19,3)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.MixLevel.mk("Lev3"),
             ModParam.MixLevel.mk("Lev4"),
             ModParam.MixLevel.mk("Lev5"),
             ModParam.MixLevel.mk("Lev6"),
             ModParam.MixLevel.mk("Lev7"),
             ModParam.MixLevel.mk("Lev8"),
             ModParam.ExpLin_2.mk("ExpLin"),
             ModParam.Pad_3.mk("Pad")),
     List.of(),
            meter()),
    M_EnvH
    (41, "Envelope Hold", 2,
     ModPage.Env.ix(1),
     List.of(in("Trig",Yellow,0,1),
             in("AM",Blue,3,1),
             in("In",Blue_red,16,1)),
     List.of(out("Env",Blue,15,1),
             out("Out",Blue_red,19,1)),
     List.of(ModParam.EnvTime.mk("Hold"),
             ModParam.PosNegInv.mk("OutputType")),
     List.of(),
            led("Gate")),
    M_Delay
    (42, "Logic Delay", 2,
     ModPage.Logic.ix(5),
     List.of(in("In",Yellow_orange,15,0),
             in("TimeMod",Blue_red,4,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(ModParam.LogicTime.mk("Time"),
             ModParam.Level_100.mk("TimeMod"),
             ModParam.LogicRange.mk("Range")),
     List.of(ModParam.LogicDelayMode.mk("Mode")),
            led()),
    M_Constant
    (43, "Constant Value", 2,
     ModPage.Level.ix(0),
     List.of(),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.LevBipUni.mk("Level"),
             ModParam.BipUni.mk("BipUni")),
     List.of()),
    M_LevMult
    (44, "Level Multiplier", 2,
     ModPage.Level.ix(6),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,14,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_FltVoice
    (45, "Filter Voice", 4,
     ModPage.Filter.ix(9),
     List.of(in("In",Red,19,0),
             in("VowelMod",Blue,9,3),
             in("FreqMod",Red,0,3)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.Vowel.mk("Vowel1"),
             ModParam.Vowel.mk("Vowel2"),
             ModParam.Vowel.mk("Vowel3"),
             ModParam.Level_100.mk("Level"),
             ModParam.Level_100.mk("Vowel"),
             ModParam.Bipolar_127.mk("VowelMod"),
             ModParam.Level_100.mk("Freq"),
             ModParam.Bipolar_127.mk("FreqMod"),
             ModParam.Bipolar_127.mk("Res"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(),
            meter()),
    M_EnvAHD
    (46, "Envelope AHD", 4,
     ModPage.Env.ix(4),
     List.of(in("Trig",Yellow,0,2),
             in("AM",Blue,0,3),
             in("In",Blue_red,19,0)),
     List.of(out("Env",Blue,18,0),
             out("Out",Blue_red,19,0)),
     List.of(ModParam.EnvShape_3.mk("Shape"),
             ModParam.EnvTime.mk("Attack"),
             ModParam.EnvTime.mk("Hold"),
             ModParam.EnvNR.mk("NR"),
             ModParam.EnvTime.mk("Decay"),
             ModParam.PosNegInv.mk("OutputType"),
             ModParam.OffOn.mk("KB")),
     List.of(),
            led("Gate")),
    M_Pan
    (47, "Pan", 2,
     ModPage.Mixer.ix(12),
     List.of(in("In",Blue_red,14,1),
             in("Mod",Blue_red,6,1)),
     List.of(out("OutL",Blue_red,16,1),
             out("OutR",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("PanMod"),
             ModParam.Bipolar_127.mk("Pan"),
             ModParam.LogLin.mk("LogLin")),
     List.of()),
    M_MixStereo
    (48, "Mixer Stereo", 5,
     ModPage.Mixer.ix(11),
     List.of(in("In1",Blue_red,0,2),
             in("In2",Blue_red,2,2),
             in("In3",Blue_red,5,2),
             in("In4",Blue_red,8,2),
             in("In5",Blue_red,10,2),
             in("In6",Blue_red,13,2)),
     List.of(out("OutL",Blue_red,17,4),
             out("OutR",Blue_red,19,4)),
     List.of(ModParam.Level_100.mk("Lev1"),
             ModParam.Level_100.mk("Lev2"),
             ModParam.Level_100.mk("Lev3"),
             ModParam.Level_100.mk("Lev4"),
             ModParam.Level_100.mk("Lev5"),
             ModParam.Level_100.mk("Lev6"),
             ModParam.Bipolar_127.mk("Pan1"),
             ModParam.Bipolar_127.mk("Pan2"),
             ModParam.Bipolar_127.mk("Pan3"),
             ModParam.Bipolar_127.mk("Pan4"),
             ModParam.Bipolar_127.mk("Pan5"),
             ModParam.Bipolar_127.mk("Pan6"),
             ModParam.Level_100.mk("LevMaster")),
     List.of(),
            meters("L","R")),
    M_FltMulti
    (49, "Filter Multi-mode", 4,
     ModPage.Filter.ix(4),
     List.of(in("In",Red,19,0),
             in("PitchVar",Blue_red,0,2),
             in("Pitch",Blue_red,0,3)),
     List.of(out("LP",Red,19,1),
             out("BP",Red,19,2),
             out("HP",Red,19,3)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Level_200.mk("PitchMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.GcOffOn.mk("GC"),
             ModParam.Res_1.mk("Res"),
             ModParam.FltSlope_1.mk("Slope"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_ConstSwT
    (50, "Constant Switch Toggling", 2,
     ModPage.Level.ix(2),
     List.of(),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.LevBipUni.mk("Lev"),
             ModParam.OffOn.mk("On").label("Switch"),
             ModParam.BipUni.mk("BipUni")),
     List.of()),
    M_FltNord
    (51, "Filter Nord", 5,
     ModPage.Filter.ix(2),
     List.of(in("In",Red,19,0),
             in("PitchVar",Blue_red,0,4),
             in("Pitch",Blue_red,0,3),
             in("FMLin",Blue_red,3,4),
             in("Res",Blue_red,9,4)),
     List.of(out("Out",Red,19,4)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Level_200.mk("PitchMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.GcOffOn.mk("GC"),
             ModParam.Res_1.mk("Res"),
             ModParam.FltSlope_2.mk("Slope"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("FM_Lin"),
             ModParam.LpBpHpBr.mk("FilterType"),
             ModParam.Level_100.mk("ResMod")),
     List.of()),
    M_EnvMulti
    (52, "Envelope Multi", 6,
     ModPage.Env.ix(6),
     List.of(in("Gate",Yellow,0,2),
             in("In",Blue_red,16,0),
             in("AM",Blue,2,2)),
     List.of(out("Env",Blue,19,1),
             out("Out",Blue_red,19,0)),
     List.of(ModParam.EnvLevel.mk("Level1"),
             ModParam.EnvLevel.mk("Level2"),
             ModParam.EnvLevel.mk("Level3"),
             ModParam.EnvLevel.mk("Level4"),
             ModParam.EnvTime.mk("Time1"),
             ModParam.EnvTime.mk("Time2"),
             ModParam.EnvTime.mk("Time3"),
             ModParam.EnvTime.mk("Time4"),
             ModParam.EnvNR.mk("NR"),
             ModParam.SustainMode_2.mk("SustainMode"),
             ModParam.PosNegInvBip.mk("OutputType"),
             ModParam.OffOn.mk("KB"),
             ModParam.EnvShape_3.mk("Shape")),
     List.of(),
            led("Gate")),
    M_S_and_H
    (53, "Sample & Hold", 2,
     ModPage.Switch.ix(16),
     List.of(in("In",Blue_red,15,1),
             in("Ctrl",Yellow_orange,12,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_FltStatic
    (54, "Filter Static", 3,
     ModPage.Filter.ix(5),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Res_1.mk("Res"),
             ModParam.LpBpHp.mk("FilterType"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.GcOffOn.mk("GC")),
     List.of()),
    M_EnvD
    (55, "Envelope Decay", 2,
     ModPage.Env.ix(2),
     List.of(in("Trig",Yellow,0,1),
             in("AM",Blue,3,1),
             in("In",Blue_red,16,1)),
     List.of(out("Env",Blue,15,1),
             out("Out",Blue_red,19,1)),
     List.of(ModParam.EnvTime.mk("Decay"),
             ModParam.PosNegInv.mk("OutputType")),
     List.of(),
            led("Gate")),
    M_Automate
    (57, "MIDI Control Automate", 2,
     ModPage.MIDI.ix(6),
     List.of(in("In",Yellow,0,1)),
     List.of(out("Out",Yellow,4,1)),
     List.of(ModParam.MidiData.mk("Ctrl"),
             ModParam.MidiData.mk("Val"),
             ModParam.MidiCh_20.mk("Ch"),
             ModParam.OffOn.mk("Echo")),
     List.of()),
    M_DrumSynth
    (58, "Drum Synthesizer", 8,
     ModPage.Osc.ix(12),
     List.of(in("Trig",Yellow,0,2),
             in("Vel",Blue,0,7),
             in("Pitch",Blue,0,4)),
     List.of(out("Out",Red,19,8)),
     List.of(ModParam.DrumSynthFreq.mk("Masterfreq"),
             ModParam.DrumSynthRatio.mk("SlaveRatio"),
             ModParam.EnvTime.mk("MasterDecay"),
             ModParam.EnvTime.mk("SlaveDecay"),
             ModParam.Level_100.mk("MasterLevel"),
             ModParam.Level_100.mk("SlaveLevel"),
             ModParam.DrumSynthNoiseFlt.mk("NoiseFltFreq"),
             ModParam.Level_100.mk("NoiseFltRes"),
             ModParam.Level_100.mk("NoiseFltSweep"),
             ModParam.EnvTime.mk("NoiseFltDecay"),
             ModParam.LpBpHp.mk("NoiseFltMode"),
             ModParam.Level_100.mk("BendAmount"),
             ModParam.EnvTime.mk("BendDecay"),
             ModParam.Level_100.mk("Click"),
             ModParam.Level_100.mk("Noise"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(),
            led("Trig")),
    M_CompLev
    (59, "Compare to Level", 2,
     ModPage.Level.ix(10),
     List.of(in("In",Blue_red,9,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(ModParam.Bipolar_127.mk("C")),
     List.of()),
    M_Mux8_1X
    (60, "Multiplexer 8-1 with variable X-Fade", 3,
     ModPage.Switch.ix(15),
     List.of(in("In1",Blue_red,5,1),
             in("In2",Blue_red,7,1),
             in("In3",Blue_red,9,1),
             in("In4",Blue_red,10,1),
             in("In5",Blue_red,12,1),
             in("In6",Blue_red,14,1),
             in("In7",Blue_red,16,1),
             in("In8",Blue_red,17,1),
             in("Ctrl",Blue,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("XFade")),
     List.of(),
            ledgroup(Visual.LedGroupType.Radio, 8)),
    M_Clip
    (61, "Clip", 2,
     ModPage.Shaper.ix(0),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,5,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("ClipLevMod"),
             ModParam.Level_100.mk("ClipLev"),
             ModParam.ClipShape.mk("Shape"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Overdrive
    (62, "Overdrive", 2,
     ModPage.Shaper.ix(1),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,8,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("AmountMod"),
             ModParam.Level_100.mk("Amount"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.OverdriveType.mk("Type"),
             ModParam.ClipShape.mk("Shape")),
     List.of()),
    M_Scratch
    (63, "Scratch", 3,
     ModPage.FX.ix(6),
     List.of(in("In",Red,19,0),
             in("Mod",Blue,0,2)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.ScratchRatio.mk("Ratio"),
             ModParam.Level_100.mk("RatioMod"),
             ModParam.ScratchDelay.mk("Delay"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Gate
    (64, "Gate", 2,
     ModPage.Logic.ix(0),
     List.of(in("In1_1",Yellow_orange,6,0),
             in("In1_2",Yellow_orange,5,1),
             in("In2_1",Yellow_orange,13,0),
             in("In2_2",Yellow_orange,12,1)),
     List.of(out("Out1",Yellow_orange,11,1),
             out("Out2",Yellow_orange,19,1)),
     List.of(),
     List.of(ModParam.GateMode.mk("GateMode1"),
             ModParam.GateMode.mk("GateMode2")),
            visuals(led("Gate1"),led("Gate2"))), // grouped singles
    M_Mix2_1B
    (66, "Scratch", 2,
     ModPage.Mixer.ix(3),
     List.of(in("In1",Blue_red,5,1),
             in("In2",Blue_red,12,1),
             in("Chain",Blue_red,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.MixInvert.mk("Inv1"),
             ModParam.MixLevel.mk("Lev1"),
             ModParam.MixInvert.mk("Inv2"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of()),
    M_ClkGen
    (68, "Clock Generator", 4,
     ModPage.LFO.ix(4),
     List.of(in("Rst",Yellow,0,1)),
     List.of(out("1/96",Yellow,19,1),
             out("1/16",Yellow,19,2),
             out("ClkActive",Yellow,19,0),
             out("Sync",Yellow,19,3)),
     List.of(ModParam.RateBpm.mk("Rate"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.InternalMaster.mk("Source"),
             ModParam.ClkGenBeatSync.mk("BeatSync"),
             ModParam.ClkGenSwing.mk("Swing")),
     List.of()),
    M_ClkDiv
    (69, "Clock Divider", 2,
     ModPage.Logic.ix(3),
     List.of(in("Clk",Yellow_orange,8,1),
             in("Rst",Yellow_orange,5,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(ModParam.Range_128.mk("Divider")),
     List.of(ModParam.ClkDivMode.mk("DivMode"))),
    M_EnvFollow
    (71, "Envelope Follower", 2,
     ModPage.Level.ix(8),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.EnvFollowAttack.mk("Attack"),
             ModParam.EnvFollowRelease.mk("Release")),
     List.of()),
    M_NoteScaler
    (72, "Note Scaler", 2,
     ModPage.Note.ix(3),
     List.of(in("In",Blue,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.NoteRange.mk("Range")),
     List.of()),
    M_WaveWrap
    (74, "Wave Wrapper", 2,
     ModPage.Shaper.ix(4),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,8,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("AmountMod"),
             ModParam.Level_100.mk("Amount"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_NoteQuant
    (75, "Note Quantizer", 2,
     ModPage.Note.ix(0),
     List.of(in("In",Blue,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.NoteRange.mk("Range"),
             ModParam.NoteQuantNotes.mk("Notes")),
     List.of()),
    M_SwOnOffT
    (76, "Switch On/Off Toggle", 2,
     ModPage.Switch.ix(1),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.OffOn.mk("On").label("On")),
     List.of()),
    M_Sw1_8
    (78, "Switch 1-8", 4,
     ModPage.Switch.ix(9),
     List.of(in("In",Blue_red,3,3)),
     List.of(out("Out1",Blue_red,6,2),
             out("Out2",Blue_red,8,3),
             out("Out3",Blue_red,10,2),
             out("Out4",Blue_red,12,3),
             out("Out5",Blue_red,13,2),
             out("Out6",Blue_red,15,3),
             out("Out7",Blue_red,17,2),
             out("Out8",Blue_red,19,3),
             out("Ctrl",Blue,0,3)),
     List.of(ModParam.Sw_3.mk("Sel")
             .label("Out 1","Out 2","Out 3","Out 4","Out 5","Out 6","Out 7","Out 8")),
     List.of()),
    M_Sw4_1
    (79, "Switch 4-1", 3,
     ModPage.Switch.ix(4),
     List.of(in("In1",Blue_red,6,1),
             in("In2",Blue_red,9,1),
             in("In3",Blue_red,13,1),
             in("In4",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,2),
             out("Ctrl",Blue,0,2)),
     List.of(ModParam.Sw_2.mk("Sel")
             .label("In 1","In 2","In 3","In 4")),
     List.of()),
    M_LevAmp
    (81, "Level Amplifier", 2,
     ModPage.Level.ix(5),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.LevAmpGain.mk("Gain"),
             ModParam.LinDB.mk("Type")),
     List.of()),
    M_Rect
    (82, "Rectifier", 2,
     ModPage.Shaper.ix(6),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.RectMode.mk("Mode"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_ShpStatic
    (83, "Shape Static", 2,
     ModPage.Shaper.ix(5),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.ShpStaticMode.mk("Mode"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_EnvADR
    (84, "Envelope ADR", 3,
     ModPage.Env.ix(3),
     List.of(in("Gate",Yellow,0,2),
             in("In",Blue_red,19,0),
             in("AM",Blue,3,2)),
     List.of(out("Env",Blue,17,2),
             out("Out",Blue_red,19,2),
             out("End",Yellow,16,2)),
     List.of(ModParam.EnvShape_3.mk("Shape"),
             ModParam.EnvTime.mk("Attack"),
             ModParam.EnvNR.mk("NR"),
             ModParam.EnvTime.mk("Release"),
             ModParam.TrigGate.mk("TG"),
             ModParam.PosNegInv.mk("OutputType"),
             ModParam.OffOn.mk("KB"),
             ModParam.AdAr.mk("DcyRel")),
     List.of(),
            led("Gate")),
    M_WindSw
    (85, "Window Switch", 2,
     ModPage.Switch.ix(12),
     List.of(in("In",Blue_red,16,1),
             in("Ctrl",Blue_red,14,1)),
     List.of(out("Out",Blue_red,19,1),
             out("Gate",Yellow_orange,0,1)),
     List.of(ModParam.Range_64.mk("ValFrom"),
             ModParam.Range_64.mk("ValTo")),
     List.of(),
            led()),
    M_8Counter
    (86, "8 Counter", 2,
     ModPage.Logic.ix(6),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,3,1)),
     List.of(out("Out1",Yellow_orange,5,1),
             out("Out2",Yellow_orange,7,1),
             out("Out3",Yellow_orange,9,1),
             out("Out4",Yellow_orange,11,1),
             out("Out5",Yellow_orange,13,1),
             out("Out6",Yellow_orange,15,1),
             out("Out7",Yellow_orange,17,1),
             out("Out8",Yellow_orange,19,1)),
     List.of(),
     List.of(),
            ledgroup(Visual.LedGroupType.Radio, 8)),
    M_FltLP
    (87, "Filter Lowpass", 2,
     ModPage.Filter.ix(0),
     List.of(in("In",Red,16,1),
             in("Pitch",Blue_red,4,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Level_100.mk("FreqMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.HpLpSlopeMode.mk("SlopeMode"))),
    M_Sw1_4
    (88, "Switch 1-4", 3,
     ModPage.Switch.ix(8),
     List.of(in("In",Blue_red,3,2)),
     List.of(out("Out1",Blue_red,6,2),
             out("Out2",Blue_red,10,2),
             out("Out3",Blue_red,13,2),
             out("Out4",Blue_red,17,2),
             out("Ctrl",Blue,0,2)),
     List.of(ModParam.Sw_2.mk("Sel")
             .label("Out 1","Out 2","Out 3","Out 4")),
     List.of()),
    M_Flanger
    (89, "Flanger", 3,
     ModPage.FX.ix(2),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FlangerRate.mk("Rate"),
             ModParam.Level_100.mk("Range"),
             ModParam.Level_100.mk("FeedBack"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Sw1_2
    (90, "Switch 1-2", 2,
     ModPage.Switch.ix(7),
     List.of(in("In",Blue_red,14,1)),
     List.of(out("Out2",Blue_red,16,1),
             out("Out1",Blue_red,19,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.Sw_1.mk("Sel")),
     List.of()),
    M_FlipFlop
    (91, "Flip Flop", 2,
     ModPage.Logic.ix(2),
     List.of(in("Clk",Yellow_orange,8,1),
             in("In",Yellow_orange,11,0),
             in("Rst",Yellow_orange,5,1)),
     List.of(out("NotQ",Yellow_orange,17,1),
             out("Q",Yellow_orange,19,0)),
     List.of(),
     List.of(ModParam.FlipFlopMode.mk("OperationMode")),
            ledgroup(Visual.LedGroupType.Radio, "QB","Q")),
    M_FltClassic
    (92, "Filter Classic", 4,
     ModPage.Filter.ix(3),
     List.of(in("In",Red,19,0),
             in("PitchVar",Blue_red,0,3),
             in("Pitch",Blue_red,0,2)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Level_200.mk("PitchMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.Level_100.mk("Res"), // TODO!! Is this different than Res_1??
             ModParam.ClassicSlope.mk("Slope"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_StChorus
    (94, "Stereo Chorus", 3,
     ModPage.FX.ix(0),
     List.of(in("In",Red,18,1)),
     List.of(out("OutL",Red,17,2),
             out("OutR",Red,19,2)),
     List.of(ModParam.Level_100.mk("Detune"),
             ModParam.Level_100.mk("Amount"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_OscD
    (96, "Osc D", 2,
     ModPage.Osc.ix(3),
     List.of(in("Pitch",Blue_red,0,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.OscWaveform_2.mk("Waveform"))),
    M_OscA
    (97, "Osc A", 3,
     ModPage.Osc.ix(0),
     List.of(in("Pitch",Blue_red,0,1),
             in("PitchVar",Blue_red,0,2)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.OscA_Waveform.mk("Waveform"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.FreqMode_3.mk("FreqMode")),
     List.of()),
    M_FreqShift
    (98, "Frequency Shifter", 3,
     ModPage.FX.ix(4),
     List.of(in("In",Red,18,0),
             in("Shift",Blue,1,2)),
     List.of(out("Dn",Red,17,1),
             out("Up",Red,19,1)),
     List.of(ModParam.FreqShiftFreq.mk("FreqShift"),
             ModParam.Level_100.mk("ShiftMod"),
             ModParam.FreqShiftRange.mk("Range"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Sw2_1
    (100, "Switch 2-1", 2,
     ModPage.Switch.ix(3),
     List.of(in("In1",Blue_red,14,0),
             in("In2",Blue_red,16,0)),
     List.of(out("Out",Blue_red,19,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.Sw_1.mk("Sel")
             .label("In 1","In 2")),
     List.of()),
    M_FltPhase
    (102, "Filter Phase", 5,
     ModPage.Filter.ix(6),
     List.of(in("In",Red,19,0),
             in("PitchVar",Blue_red,0,4),
             in("Spr",Blue,6,4),
             in("FB",Blue,9,4),
             in("Pitch",Blue_red,0,3)),
     List.of(out("Out",Red,19,4)),
     List.of(ModParam.Level_100.mk("PitchMod"),
             ModParam.Freq_2.mk("Freq"),
             ModParam.Level_100.mk("SpreadMod"),
             ModParam.Bipolar_127.mk("FB"),
             ModParam.FltPhaseNotchCount.mk("NotchCount"),
             ModParam.Level_100.mk("Spread"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("Level"),
             ModParam.Level_100.mk("FBMod"),
             ModParam.FltPhaseType.mk("Type"),
             ModParam.Kbt_4.mk("Kbt")),
     List.of(),
            meter()),
    M_EqPeak
    (103, "Eq Peak", 4,
     ModPage.Filter.ix(11),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.Freq_3.mk("Freq"),
             ModParam.EqdB.mk("Gain"),
             ModParam.EqPeakBandwidth.mk("Bandwidth"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("Level")),
     List.of(),
            meter()),
    M_ValSw2_1
    (105, "Value Switch 2-1", 2,
     ModPage.Switch.ix(10),
     List.of(in("In1",Blue_red,14,1),
             in("In2",Blue_red,16,1),
             in("Ctrl",Blue_red,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.ValSwVal.mk("Val")),
     List.of(),
            led()),
    M_OscNoise
    (106, "Oscillator Noise", 3,
     ModPage.Osc.ix(8),
     List.of(in("Pitch",Blue_red,0,1),
             in("PitchVar",Blue_red,0,2),
             in("Width",Blue_red,12,2)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("Width"),
             ModParam.Level_100.mk("WidthMod"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Vocoder
    (108, "Vocoder", 8,
     ModPage.Filter.ix(10),
     List.of(in("Ctrl",Red,0,2),
             in("In",Red,16,7)),
     List.of(out("Out",Red,19,7)),
     List.of(ModParam.VocoderBand.mk("Band1"),
             ModParam.VocoderBand.mk("Band2"),
             ModParam.VocoderBand.mk("Band3"),
             ModParam.VocoderBand.mk("Band4"),
             ModParam.VocoderBand.mk("Band5"),
             ModParam.VocoderBand.mk("Band6"),
             ModParam.VocoderBand.mk("Band7"),
             ModParam.VocoderBand.mk("Band8"),
             ModParam.VocoderBand.mk("Band9"),
             ModParam.VocoderBand.mk("Band10"),
             ModParam.VocoderBand.mk("Band11"),
             ModParam.VocoderBand.mk("Band12"),
             ModParam.VocoderBand.mk("Band13"),
             ModParam.VocoderBand.mk("Band14"),
             ModParam.VocoderBand.mk("Band15"),
             ModParam.VocoderBand.mk("Band16"),
             ModParam.OffOn.mk("Emphasis"),
             ModParam.ActiveMonitor.mk("Monitor")),
     List.of()),
    M_LevAdd
    (112, "Level Add", 2,
     ModPage.Level.ix(3),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.LevBipUni.mk("Level"),
             ModParam.BipUni.mk("BipUni")),
     List.of()),
    M_Fade1_2
    (113, "Fade 1-2", 2,
     ModPage.Mixer.ix(14),
     List.of(in("In",Blue_red,14,1),
             in("Mod",Blue_red,6,1)),
     List.of(out("Out1",Blue_red,17,1),
             out("Out2",Blue_red,19,1)),
     List.of(ModParam.Fade12Mix.mk("Mix"),
             ModParam.Level_100.mk("MixMod")),
     List.of()),
    M_Fade2_1
    (114, "Fade 2-1", 2,
     ModPage.Mixer.ix(15),
     List.of(in("In1",Blue_red,14,1),
             in("In2",Blue_red,16,1),
             in("Mod",Blue_red,6,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Fade21Mix.mk("Mix"),
             ModParam.Level_100.mk("MixMod")),
     List.of()),
    M_LevScaler
    (115, "Level Scaler", 3,
     ModPage.Note.ix(7),
     List.of(in("Note",Blue,0,2),
             in("In",Blue_red,19,0)),
     List.of(out("Level",Blue,16,2),
             out("Out",Blue_red,19,2)),
     List.of(ModParam.LevScaledB.mk("L"),
             ModParam.FreqCoarse.mk("BP"),
             ModParam.LevScaledB.mk("R"),
             ModParam.Kbt_1.mk("Kbt")),
     List.of()),
    M_Mix8_1A
    (116, "Mix 8-1 A", 2,
     ModPage.Mixer.ix(8),
     List.of(in("In1",Blue_red,5,1),
             in("In2",Blue_red,7,1),
             in("In3",Blue_red,8,1),
             in("In4",Blue_red,10,1),
             in("In5",Blue_red,12,1),
             in("In6",Blue_red,13,1),
             in("In7",Blue_red,15,1),
             in("In8",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Pad_3.mk("Pad")),
     List.of(),
            meter()),
    M_LevMod
    (117, "Level Modulator", 3,
     ModPage.Level.ix(7),
     List.of(in("In",Blue_red,16,2),
             in("Mod",Blue_red,16,0),
             in("ModDepth",Blue_red,6,2)),
     List.of(out("Out",Blue_red,19,2)),
     List.of(ModParam.Level_100.mk("ModDepth"),
             ModParam.LevModAmRm.mk("ModType")),
     List.of()),
    M_Digitizer
    (118, "Digitizer", 3,
     ModPage.FX.ix(3),
     List.of(in("In",Blue_red,19,0),
             in("Rate",Blue_red,19,2)),
     List.of(out("Out",Blue_red,1,2)),
     List.of(ModParam.DigitizerBits.mk("Bits"),
             ModParam.DigitizerRate.mk("Rate"),
             ModParam.Level_100.mk("RateMod"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_EnvADDSR
    (119, "Envelope ADDSR", 5,
     ModPage.Env.ix(5),
     List.of(in("Gate",Yellow,0,2),
             in("AM",Blue,0,3),
             in("In",Blue_red,19,0)),
     List.of(out("Env",Blue,17,3),
             out("Out",Blue_red,19,3)),
     List.of(ModParam.OffOn.mk("KB"),
             ModParam.EnvShape_3.mk("Shape"),
             ModParam.EnvTime.mk("Attack"),
             ModParam.EnvTime.mk("Decay1"),
             ModParam.EnvLevel.mk("Level1"),
             ModParam.EnvTime.mk("Decay2"),
             ModParam.EnvLevel.mk("Level2"),
             ModParam.EnvTime.mk("Release"),
             ModParam.SustainMode_1.mk("SustainMode"),
             ModParam.PosNegInvBipInv.mk("OutputType"),
             ModParam.EnvNR.mk("NR")),
     List.of(),
            led("Gate")),
    M_SeqNote
    (121, "Sequencer Note", 9,
     ModPage.Seq.ix(3),
     List.of(in("Clk",Yellow_orange,0,2),
             in("Rst",Yellow_orange,0,4),
             in("Loop",Yellow_orange,0,6),
             in("Park",Yellow_orange,16,0),
             in("Note",Blue_red,0,7),
             in("Trig",Yellow_orange,0,8),
             in("RecVal",Blue_red,7,0),
             in("RecEnable",Yellow_orange,8,0)),
     List.of(out("Link",Yellow_orange,19,1),
             out("Note",Blue_red,19,7),
             out("Trig",Yellow_orange,19,8)),
     List.of(ModParam.FreqCoarse.mk("Seq1Step1"),
             ModParam.FreqCoarse.mk("Seq1Step2"),
             ModParam.FreqCoarse.mk("Seq1Step3"),
             ModParam.FreqCoarse.mk("Seq1Step4"),
             ModParam.FreqCoarse.mk("Seq1Step5"),
             ModParam.FreqCoarse.mk("Seq1Step6"),
             ModParam.FreqCoarse.mk("Seq1Step7"),
             ModParam.FreqCoarse.mk("Seq1Step8"),
             ModParam.FreqCoarse.mk("Seq1Step9"),
             ModParam.FreqCoarse.mk("Seq1Step10"),
             ModParam.FreqCoarse.mk("Seq1Step11"),
             ModParam.FreqCoarse.mk("Seq1Step12"),
             ModParam.FreqCoarse.mk("Seq1Step13"),
             ModParam.FreqCoarse.mk("Seq1Step14"),
             ModParam.FreqCoarse.mk("Seq1Step15"),
             ModParam.FreqCoarse.mk("Seq1Step16"),
             ModParam.OffOn.mk("Seq2Step1"),
             ModParam.OffOn.mk("Seq2Step2"),
             ModParam.OffOn.mk("Seq2Step3"),
             ModParam.OffOn.mk("Seq2Step4"),
             ModParam.OffOn.mk("Seq2Step5"),
             ModParam.OffOn.mk("Seq2Step6"),
             ModParam.OffOn.mk("Seq2Step7"),
             ModParam.OffOn.mk("Seq2Step8"),
             ModParam.OffOn.mk("Seq2Step9"),
             ModParam.OffOn.mk("Seq2Step10"),
             ModParam.OffOn.mk("Seq2Step11"),
             ModParam.OffOn.mk("Seq2Step12"),
             ModParam.OffOn.mk("Seq2Step13"),
             ModParam.OffOn.mk("Seq2Step14"),
             ModParam.OffOn.mk("Seq2Step15"),
             ModParam.OffOn.mk("Seq2Step16"),
             ModParam.LoopOnce.mk("Loop"),
             ModParam.SeqLen.mk("Length"),
             ModParam.TrigGate.mk("TG"),
             ModParam.OffOn.mk("Clr_Or_Rnd"),
             ModParam.OffOn.mk("Rnd_Or_Clr")),
     List.of(),
            visuals(ledgroup(Visual.LedGroupType.Radio, 16),led("Link"))),
    M_Mix4_1C
    (123, "Mixer 4-1 C", 4,
     ModPage.Mixer.ix(6),
     List.of(in("In1",Blue_red,3,1),
             in("In2",Blue_red,7,1),
             in("In3",Blue_red,11,1),
             in("In4",Blue_red,15,1),
             in("Chain",Blue_red,19,0)),
     List.of(out("Out",Blue_red,19,3)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.MixLevel.mk("Lev3"),
             ModParam.MixLevel.mk("Lev4"),
             ModParam.OffOn.mk("On1").label("Ch 1"),
             ModParam.OffOn.mk("On2").label("Ch 2"),
             ModParam.OffOn.mk("On3").label("Ch 3"),
             ModParam.OffOn.mk("On4").label("Ch 4"),
             ModParam.Pad_2.mk("Pad"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of(),
            meter()),
    M_Mux8_1
    (124, "Multiplexer 8-1", 2,
     ModPage.Switch.ix(13),
     List.of(in("In1",Blue_red,4,1),
             in("In2",Blue_red,7,1),
             in("In3",Blue_red,9,1),
             in("In4",Blue_red,11,1),
             in("In5",Blue_red,12,1),
             in("In6",Blue_red,14,1),
             in("In7",Blue_red,15,1),
             in("In8",Blue_red,17,1),
             in("Ctrl",Blue,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of(),
            ledgroup(Visual.LedGroupType.Radio, 8)),
    M_WahWah
    (125, "Wah-Wah", 2,
     ModPage.Filter.ix(8),
     List.of(in("In",Red,16,1),
             in("Sweep",Blue,7,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.Level_100.mk("SweepMod"),
             ModParam.Level_100.mk("Sweep"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Name
    (126, "Name Bar", 1,
     ModPage.InOut.ix(10),
     List.of(),
     List.of(),
     List.of(),
     List.of()),
    M_Fx_In
    (127, "Fx Input", 2,
     ModPage.InOut.ix(4),
     List.of(),
     List.of(out("OutL",Red,16,1),
             out("OutR",Red,19,1)),
     List.of(ModParam.Source_1.mk("Source"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Pad_4.mk("Pad")),
     List.of(),
            meters("L","R")),
    M_MinMax
    (128, "Min/Max Compare", 2,
     ModPage.Level.ix(12),
     List.of(in("A",Blue_red,9,1),
             in("B",Blue_red,11,1)),
     List.of(out("Min",Blue_red,17,1),
             out("Max",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_BinCounter
    (130, "Binary Counter", 2,
     ModPage.Logic.ix(7),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,2,1)),
     List.of(out("Out001",Yellow_orange,5,1),
             out("Out002",Yellow_orange,7,1),
             out("Out004",Yellow_orange,9,1),
             out("Out008",Yellow_orange,11,1),
             out("Out016",Yellow_orange,13,1),
             out("Out032",Yellow_orange,15,1),
             out("Out064",Yellow_orange,17,1),
             out("Out128",Yellow_orange,19,1)),
     List.of(),
     List.of(),
            ledgroup(Visual.LedGroupType.BinCounter, 8)),
    M_ADConv
    (131, "A/D Converter", 2,
     ModPage.Logic.ix(8),
     List.of(in("In",Blue_red,0,1)),
     List.of(out("D0",Yellow_orange,5,1),
             out("D1",Yellow_orange,7,1),
             out("D2",Yellow_orange,9,1),
             out("D3",Yellow_orange,11,1),
             out("D4",Yellow_orange,13,1),
             out("D5",Yellow_orange,15,1),
             out("D6",Yellow_orange,17,1),
             out("D7",Yellow_orange,19,1)),
     List.of(),
     List.of(),
            ledgroup(Visual.LedGroupType.ADConv, 8)),
    M_DAConv
    (132, "D/A Converter", 2,
     ModPage.Logic.ix(9),
     List.of(in("D0",Yellow_orange,5,1),
             in("D1",Yellow_orange,7,1),
             in("D2",Yellow_orange,9,1),
             in("D3",Yellow_orange,11,1),
             in("D4",Yellow_orange,12,1),
             in("D5",Yellow_orange,13,1),
             in("D6",Yellow_orange,15,1),
             in("D7",Yellow_orange,17,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_FltHP
    (134, "Filter Highpass", 2,
     ModPage.Filter.ix(1),
     List.of(in("In",Red,16,1),
             in("Pitch",Blue,4,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.FltFreq.mk("Freq"),
             ModParam.Level_100.mk("FreqMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.HpLpSlopeMode.mk("SlopeMode"))),
    M_T_and_H
    (139, "Track & Hold", 2,
     ModPage.Switch.ix(17),
     List.of(in("In",Blue_red,15,1),
             in("Ctrl",Yellow_orange,12,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_Mix4_1S
    (140, "Mixer 4-1 Stereo", 4,
     ModPage.Mixer.ix(7),
     List.of(in("In1L",Blue_red,0,1),
             in("In1R",Blue_red,1,1),
             in("In2L",Blue_red,4,1),
             in("In2R",Blue_red,5,1),
             in("In3L",Blue_red,8,1),
             in("In3R",Blue_red,9,1),
             in("In4L",Blue_red,13,1),
             in("In4R",Blue_red,14,1),
             in("ChainL",Blue_red,17,0),
             in("ChainR",Blue_red,19,0)),
     List.of(out("OutL",Blue_red,17,3),
             out("OutR",Blue_red,19,3)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.MixLevel.mk("Lev3"),
             ModParam.MixLevel.mk("Lev4"),
             ModParam.OffOn.mk("On1").label("Ch 1"),
             ModParam.OffOn.mk("On2").label("Ch 2"),
             ModParam.OffOn.mk("On3").label("Ch 3"),
             ModParam.OffOn.mk("On4").label("Ch 4"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of(),
            meters("L","R")),
    M_CtrlSend
    (141, "MIDI Control Send", 2,
     ModPage.MIDI.ix(0),
     List.of(in("Send",Yellow,1,1),
             in("Value",Blue,11,1)),
     List.of(out("Send",Yellow,4,1)),
     List.of(ModParam.MidiData.mk("Ctrl"),
             ModParam.MidiData.mk("Val"),
             ModParam.MidiCh_20.mk("Ch")),
     List.of()),
    M_PCSend
    (142, "MIDI Program Change Send", 2,
     ModPage.MIDI.ix(1),
     List.of(in("Send",Yellow,1,1),
             in("Program",Blue,11,1)),
     List.of(out("Send",Yellow,4,1)),
     List.of(ModParam.MidiData.mk("Program"),
             ModParam.MidiCh_16.mk("Ch")),
     List.of()),
    M_NoteSend
    (143, "MIDI Note Send", 2,
     ModPage.MIDI.ix(2),
     List.of(in("Gate",Yellow,0,1),
             in("Vel",Blue,4,1),
             in("Note",Blue,10,1)),
     List.of(),
     List.of(ModParam.MidiData.mk("Vel"),
             ModParam.MidiData.mk("Note"),
             ModParam.MidiCh_20.mk("Ch")),
     List.of()),
    M_SeqEvent
    (144, "Seq Event", 5,
     ModPage.Seq.ix(0),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow,0,2),
             in("Loop",Yellow,0,4),
             in("Park",Yellow,16,0),
             in("Trig1",Yellow,1,3),
             in("Trig2",Yellow,1,4)),
     List.of(out("Link",Yellow,19,1),
             out("Trig1",Yellow_orange,19,3),
             out("Trig2",Yellow_orange,19,4)),
     List.of(ModParam.OffOn.mk("Seq1Step1"),
             ModParam.OffOn.mk("Seq1Step2"),
             ModParam.OffOn.mk("Seq1Step3"),
             ModParam.OffOn.mk("Seq1Step4"),
             ModParam.OffOn.mk("Seq1Step5"),
             ModParam.OffOn.mk("Seq1Step6"),
             ModParam.OffOn.mk("Seq1Step7"),
             ModParam.OffOn.mk("Seq1Step8"),
             ModParam.OffOn.mk("Seq1Step9"),
             ModParam.OffOn.mk("Seq1Step10"),
             ModParam.OffOn.mk("Seq1Step11"),
             ModParam.OffOn.mk("Seq1Step12"),
             ModParam.OffOn.mk("Seq1Step13"),
             ModParam.OffOn.mk("Seq1Step14"),
             ModParam.OffOn.mk("Seq1Step15"),
             ModParam.OffOn.mk("Seq1Step16"),
             ModParam.OffOn.mk("Seq2Step1"),
             ModParam.OffOn.mk("Seq2Step2"),
             ModParam.OffOn.mk("Seq2Step3"),
             ModParam.OffOn.mk("Seq2Step4"),
             ModParam.OffOn.mk("Seq2Step5"),
             ModParam.OffOn.mk("Seq2Step6"),
             ModParam.OffOn.mk("Seq2Step7"),
             ModParam.OffOn.mk("Seq2Step8"),
             ModParam.OffOn.mk("Seq2Step9"),
             ModParam.OffOn.mk("Seq2Step10"),
             ModParam.OffOn.mk("Seq2Step11"),
             ModParam.OffOn.mk("Seq2Step12"),
             ModParam.OffOn.mk("Seq2Step13"),
             ModParam.OffOn.mk("Seq2Step14"),
             ModParam.OffOn.mk("Seq2Step15"),
             ModParam.OffOn.mk("Seq2Step16"),
             ModParam.LoopOnce.mk("Loop"),
             ModParam.SeqLen.mk("Length"),
             ModParam.TrigGate.mk("TG1"),
             ModParam.TrigGate.mk("TG2")),
     List.of(),
            visuals(ledgroup(Visual.LedGroupType.Radio, 16),led("Link"))),
    M_SeqVal
    (145, "Sequencer Values", 8,
     ModPage.Seq.ix(1),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow,0,3),
             in("Loop",Yellow,0,4),
             in("Park",Yellow,16,0),
             in("Val",Blue_red,0,5),
             in("Trig",Yellow,0,7)),
     List.of(out("Link",Yellow,19,1),
             out("Val",Blue_red,19,5),
             out("Trig",Yellow_orange,19,7)),
     List.of(ModParam.LevBipUni.mk("Seq1Step1"),
             ModParam.LevBipUni.mk("Seq1Step2"),
             ModParam.LevBipUni.mk("Seq1Step3"),
             ModParam.LevBipUni.mk("Seq1Step4"),
             ModParam.LevBipUni.mk("Seq1Step5"),
             ModParam.LevBipUni.mk("Seq1Step6"),
             ModParam.LevBipUni.mk("Seq1Step7"),
             ModParam.LevBipUni.mk("Seq1Step8"),
             ModParam.LevBipUni.mk("Seq1Step9"),
             ModParam.LevBipUni.mk("Seq1Step10"),
             ModParam.LevBipUni.mk("Seq1Step11"),
             ModParam.LevBipUni.mk("Seq1Step12"),
             ModParam.LevBipUni.mk("Seq1Step13"),
             ModParam.LevBipUni.mk("Seq1Step14"),
             ModParam.LevBipUni.mk("Seq1Step15"),
             ModParam.LevBipUni.mk("Seq1Step16"),
             ModParam.OffOn.mk("Seq2Step1"),
             ModParam.OffOn.mk("Seq2Step2"),
             ModParam.OffOn.mk("Seq2Step3"),
             ModParam.OffOn.mk("Seq2Step4"),
             ModParam.OffOn.mk("Seq2Step5"),
             ModParam.OffOn.mk("Seq2Step6"),
             ModParam.OffOn.mk("Seq2Step7"),
             ModParam.OffOn.mk("Seq2Step8"),
             ModParam.OffOn.mk("Seq2Step9"),
             ModParam.OffOn.mk("Seq2Step10"),
             ModParam.OffOn.mk("Seq2Step11"),
             ModParam.OffOn.mk("Seq2Step12"),
             ModParam.OffOn.mk("Seq2Step13"),
             ModParam.OffOn.mk("Seq2Step14"),
             ModParam.OffOn.mk("Seq2Step15"),
             ModParam.OffOn.mk("Seq2Step16"),
             ModParam.LoopOnce.mk("Loop"),
             ModParam.SeqLen.mk("Length"),
             ModParam.BipUni.mk("BipUni"),
             ModParam.TrigGate.mk("TG"),
             ModParam.OffOn.mk("Clr_Or_Rnd"),
             ModParam.OffOn.mk("Rnd_Or_Clr")),
     List.of(),
            visuals(ledgroup(Visual.LedGroupType.Radio, 16),led("Link"))),
    M_SeqLev
    (146, "Sequencer Level", 8,
     ModPage.Seq.ix(2),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,0,3),
             in("Loop",Yellow_orange,0,4),
             in("Park",Yellow_orange,16,0),
             in("Val",Blue_red,0,6),
             in("Trig",Yellow_orange,0,7)),
     List.of(out("Link",Yellow_orange,19,1),
             out("Val",Blue_red,19,6),
             out("Trig",Yellow_orange,19,7)),
     List.of(ModParam.LevBipUni.mk("Seq1Step1"),
             ModParam.LevBipUni.mk("Seq1Step2"),
             ModParam.LevBipUni.mk("Seq1Step3"),
             ModParam.LevBipUni.mk("Seq1Step4"),
             ModParam.LevBipUni.mk("Seq1Step5"),
             ModParam.LevBipUni.mk("Seq1Step6"),
             ModParam.LevBipUni.mk("Seq1Step7"),
             ModParam.LevBipUni.mk("Seq1Step8"),
             ModParam.LevBipUni.mk("Seq1Step9"),
             ModParam.LevBipUni.mk("Seq1Step10"),
             ModParam.LevBipUni.mk("Seq1Step11"),
             ModParam.LevBipUni.mk("Seq1Step12"),
             ModParam.LevBipUni.mk("Seq1Step13"),
             ModParam.LevBipUni.mk("Seq1Step14"),
             ModParam.LevBipUni.mk("Seq1Step15"),
             ModParam.LevBipUni.mk("Seq1Step16"),
             ModParam.OffOn.mk("Seq2Step1"),
             ModParam.OffOn.mk("Seq2Step2"),
             ModParam.OffOn.mk("Seq2Step3"),
             ModParam.OffOn.mk("Seq2Step4"),
             ModParam.OffOn.mk("Seq2Step5"),
             ModParam.OffOn.mk("Seq2Step6"),
             ModParam.OffOn.mk("Seq2Step7"),
             ModParam.OffOn.mk("Seq2Step8"),
             ModParam.OffOn.mk("Seq2Step9"),
             ModParam.OffOn.mk("Seq2Step10"),
             ModParam.OffOn.mk("Seq2Step11"),
             ModParam.OffOn.mk("Seq2Step12"),
             ModParam.OffOn.mk("Seq2Step13"),
             ModParam.OffOn.mk("Seq2Step14"),
             ModParam.OffOn.mk("Seq2Step15"),
             ModParam.OffOn.mk("Seq2Step16"),
             ModParam.LoopOnce.mk("Loop"),
             ModParam.SeqLen.mk("Length"),
             ModParam.BipUni.mk("BipUni"),
             ModParam.TrigGate.mk("TG"),
             ModParam.OffOn.mk("Clr_Or_Rnd"),
             ModParam.OffOn.mk("Rnd_Or_Clr")),
     List.of(),
            visuals(ledgroup(Visual.LedGroupType.Radio, 16),led("Link"))),
    M_CtrlRcv
    (147, "MIDI Control Receive", 2,
     ModPage.MIDI.ix(3),
     List.of(),
     List.of(out("Rcv",Yellow,16,1),
             out("Val",Blue,19,1)),
     List.of(ModParam.MidiData.mk("Ctrl"),
             ModParam.MidiCh_16.mk("Ch")),
     List.of()),
    M_NoteRcv
    (148, "MIDI Note Receive", 2,
     ModPage.MIDI.ix(4),
     List.of(),
     List.of(out("Gate",Yellow,14,1),
             out("Vel",Blue,16,1),
             out("RelVel",Blue,18,1)),
     List.of(ModParam.MidiData.mk("Note"),
             ModParam.MidiCh_17.mk("Ch")),
     List.of()),
    M_NoteZone
    (149, "MIDI Note Zone", 3,
     ModPage.MIDI.ix(5),
     List.of(),
     List.of(),
     List.of(ModParam.MidiCh_17.mk("RcvCh"),
             ModParam.MidiData.mk("RcvMin"),
             ModParam.MidiData.mk("RcvMax"),
             ModParam.Bipolar_127.mk("SendTrans"),
             ModParam.MidiCh_20.mk("SendCh"),
             ModParam.NoteZoneThru.mk("ThruMode")),
     List.of()),
    M_Compress
    (150, "Compressor", 5,
     ModPage.FX.ix(8),
     List.of(in("InL",Red,18,1),
             in("InR",Red,19,1),
             in("SideChain",Red,5,0)),
     List.of(out("OutR",Red,18,4),
             out("OutL",Red,19,4)),
     List.of(ModParam.Threshold_42.mk("Threshold"),
             ModParam.CompressorRatio.mk("Ratio"),
             ModParam.CompressorAttack.mk("Attack"),
             ModParam.CompressorRelease.mk("Release"),
             ModParam.CompressorRefLevel.mk("RefLevel"),
             ModParam.OffOn.mk("SideChain"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(),
            ledgroup(Visual.LedGroupType.Compressor, 10)),
    M_KeyQuant
    (152, "Key Quantizer", 2,
     ModPage.Note.ix(1),
     List.of(in("In",Blue,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.NoteRange.mk("Range"),
             ModParam.KeyQuantCapture.mk("Capture"),
             ModParam.OffOn.mk("E"),
             ModParam.OffOn.mk("F"),
             ModParam.OffOn.mk("F#"),
             ModParam.OffOn.mk("G"),
             ModParam.OffOn.mk("G#"),
             ModParam.OffOn.mk("A"),
             ModParam.OffOn.mk("A#"),
             ModParam.OffOn.mk("B"),
             ModParam.OffOn.mk("C"),
             ModParam.OffOn.mk("C#"),
             ModParam.OffOn.mk("D"),
             ModParam.OffOn.mk("D#")),
     List.of()),
    M_SeqCtr
    (154, "Sequencer Controlled", 8,
     ModPage.Seq.ix(4),
     List.of(in("Ctrl",Blue_red,0,1),
             in("Val",Blue_red,0,5),
             in("Trig",Yellow_orange,0,7)),
     List.of(out("Val",Blue_red,19,5),
             out("Trig",Yellow_orange,19,7)),
     List.of(ModParam.LevBipUni.mk("Seq1Step1"),
             ModParam.LevBipUni.mk("Seq1Step2"),
             ModParam.LevBipUni.mk("Seq1Step3"),
             ModParam.LevBipUni.mk("Seq1Step4"),
             ModParam.LevBipUni.mk("Seq1Step5"),
             ModParam.LevBipUni.mk("Seq1Step6"),
             ModParam.LevBipUni.mk("Seq1Step7"),
             ModParam.LevBipUni.mk("Seq1Step8"),
             ModParam.LevBipUni.mk("Seq1Step9"),
             ModParam.LevBipUni.mk("Seq1Step10"),
             ModParam.LevBipUni.mk("Seq1Step11"),
             ModParam.LevBipUni.mk("Seq1Step12"),
             ModParam.LevBipUni.mk("Seq1Step13"),
             ModParam.LevBipUni.mk("Seq1Step14"),
             ModParam.LevBipUni.mk("Seq1Step15"),
             ModParam.LevBipUni.mk("Seq1Step16"),
             ModParam.OffOn.mk("Seq2Step1"),
             ModParam.OffOn.mk("Seq2Step2"),
             ModParam.OffOn.mk("Seq2Step3"),
             ModParam.OffOn.mk("Seq2Step4"),
             ModParam.OffOn.mk("Seq2Step5"),
             ModParam.OffOn.mk("Seq2Step6"),
             ModParam.OffOn.mk("Seq2Step7"),
             ModParam.OffOn.mk("Seq2Step8"),
             ModParam.OffOn.mk("Seq2Step9"),
             ModParam.OffOn.mk("Seq2Step10"),
             ModParam.OffOn.mk("Seq2Step11"),
             ModParam.OffOn.mk("Seq2Step12"),
             ModParam.OffOn.mk("Seq2Step13"),
             ModParam.OffOn.mk("Seq2Step14"),
             ModParam.OffOn.mk("Seq2Step15"),
             ModParam.OffOn.mk("Seq2Step16"),
             ModParam.TrigGate.mk("TG"),
             ModParam.BipUni.mk("BipUni"),
             ModParam.SeqCtrlXFade.mk("XFade"),
             ModParam.OffOn.mk("Clr_Or_Rnd"),
             ModParam.OffOn.mk("Rnd_Or_Clr")),
     List.of(),
            visuals(ledgroup(Visual.LedGroupType.Radio, 16),led("Link"))),
    M_NoteDet
    (156, "Note Detector", 2,
     ModPage.InOut.ix(9),
     List.of(),
     List.of(out("Gate",Yellow,13,1),
             out("Vel",Blue,16,1),
             out("RelVel",Blue,19,1)),
     List.of(ModParam.FreqCoarse.mk("Note")),
     List.of(),
            led("Gate")),
    M_LevConv
    (157, "Level Converter", 2,
     ModPage.Level.ix(4),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.PosNegInvBipInv.mk("OutputType"),
             ModParam.BipPosNeg.mk("InputType")),
     List.of()),
    M_Glide
    (158, "Glide", 2,
     ModPage.Note.ix(4),
     List.of(in("In",Blue_red,16,1),
             in("On",Yellow_orange,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.GlideTime.mk("Time"),
             ModParam.OffOn.mk("Glide"),
             ModParam.LogLin.mk("Shape")),
     List.of()),
    M_CompSig
    (159, "Compare to Signal", 2,
     ModPage.Level.ix(11),
     List.of(in("A",Blue_red,9,1),
             in("B",Blue_red,11,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(),
     List.of()),
    M_ZeroCnt
    (160, "Zero Crossing Counter", 2,
     ModPage.Note.ix(6),
     List.of(in("In",Blue_red,16,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(),
     List.of()),
    M_MixFader
    (161, "Mixer 8-1 Fader", 9,
     ModPage.Mixer.ix(10),
     List.of(in("In1",Blue_red,1,1),
             in("In2",Blue_red,2,1),
             in("In3",Blue_red,5,1),
             in("In4",Blue_red,7,1),
             in("In5",Blue_red,10,1),
             in("In6",Blue_red,12,1),
             in("In7",Blue_red,14,1),
             in("In8",Blue_red,17,1),
             in("Chain",Blue_red,19,0)),
     List.of(out("Out",Blue_red,19,8)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.MixLevel.mk("Lev3"),
             ModParam.MixLevel.mk("Lev4"),
             ModParam.MixLevel.mk("Lev5"),
             ModParam.MixLevel.mk("Lev6"),
             ModParam.MixLevel.mk("Lev7"),
             ModParam.MixLevel.mk("Lev8"),
             ModParam.OffOn.mk("On1").label("Ch 1"),
             ModParam.OffOn.mk("On2").label("Ch 2"),
             ModParam.OffOn.mk("On3").label("Ch 3"),
             ModParam.OffOn.mk("On4").label("Ch 4"),
             ModParam.OffOn.mk("On5").label("Ch 5"),
             ModParam.OffOn.mk("On6").label("Ch 6"),
             ModParam.OffOn.mk("On7").label("Ch 7"),
             ModParam.OffOn.mk("On8").label("Ch 8"),

             ModParam.ExpLin_2.mk("ExpLin"),
             ModParam.Pad_3.mk("Pad")),
     List.of(),
            meter()),
    M_FltComb
    (162, "Filter Comb", 4,
     ModPage.Filter.ix(7),
     List.of(in("In",Red,19,0),
             in("Pitch",Blue_red,0,2),
             in("PitchVar",Blue_red,0,3),
             in("FB",Blue,9,3)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.Freq_1.mk("Freq"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.Bipolar_127.mk("FB"),
             ModParam.Level_100.mk("FBMod"),
             ModParam.CombType.mk("Type"),
             ModParam.Level_100.mk("Lev"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(),
            meter()),
    M_OscShpA
    (163, "Osc Shape A", 5,
     ModPage.Osc.ix(5),
     List.of(in("Pitch",Blue_red,0,3),
             in("PitchVar",Blue_red,0,4),
             in("Sync",Red,0,1),
             in("FmMod",Red,8,3),
             in("ShapeMod",Red,14,3)),
     List.of(out("Out",Red,19,4)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("FmAmount"),
             ModParam.FmLinTrk.mk("FmMode"),
             ModParam.PW.mk("Shape"),
             ModParam.Level_100.mk("ShapeMod"),
             ModParam.OscShpA_Waveform.mk("Waveform"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_OscDual
    (164, "Osc Dual", 5,
     ModPage.Osc.ix(7),
     List.of(in("Pitch",Blue_red,0,3),
             in("PitchVar",Blue_red,0,4),
             in("Sync",Red,0,1),
             in("PW",Red,9,1),
             in("Phase",Red,9,4)),
     List.of(out("Out",Red,19,4)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("SqrLevel"),
             ModParam.Level_100.mk("PWMod"),
             ModParam.Level_100.mk("SawLevel"),
             ModParam.Phase.mk("SawPhase"),
             ModParam.Level_100.mk("SubOctLevel"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.PW.mk("SqrPW"),
             ModParam.Level_100.mk("PhaseMod"),
             ModParam.OffOn.mk("Soft")),
     List.of()),
    M_DXRouter
    (165, "DX Style Router", 6,
     ModPage.Osc.ix(15),
     List.of(in("In1",Red,0,5),
             in("In2",Red,2,5),
             in("In3",Red,5,5),
             in("In4",Red,9,5),
             in("In5",Red,12,5),
             in("In6",Red,15,5)),
     List.of(out("Out1",Red,1,5),
             out("Out2",Red,4,5),
             out("Out3",Red,7,5),
             out("Out4",Red,10,5),
             out("Out5",Red,13,5),
             out("Out6",Red,16,5),
             out("Main",Red,19,5)),
     List.of(ModParam.DxAlgorithm.mk("Algorithm"),
             ModParam.DxFeedback.mk("Feedback")),
     List.of()),
    M_PShift
    (167, "Pitch Shifter", 3,
     ModPage.FX.ix(5),
     List.of(in("In",Red,19,0),
             in("Pitch",Blue,1,2)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.PShiftCoarse.mk("ShiftSemi"),
             ModParam.PShiftFine.mk("ShiftFine"),
             ModParam.Level_100.mk("ShiftMod"),
             ModParam.ScratchDelay.mk("Delay"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_ModAHD
    (169, "Envelope Modulation AHD", 5,
     ModPage.Env.ix(7),
     List.of(in("Trig",Yellow,0,2),
             in("AttackMod",Blue,4,4),
             in("HoldMod",Blue,8,4),
             in("DecayMod",Blue,12,4),
             in("In",Blue_red,19,0),
             in("AM",Blue,0,4)),
     List.of(out("Env",Blue,18,4),
             out("Out",Blue_red,19,4)),
     List.of(ModParam.EnvTime.mk("Attack"),
             ModParam.EnvTime.mk("Hold"),
             ModParam.EnvTime.mk("Decay"),
             ModParam.Level_100.mk("AttackMod"),
             ModParam.Level_100.mk("HoldMod"),
             ModParam.Level_100.mk("DecayMod"),
             ModParam.PosNegInv.mk("OutputType"),
             ModParam.OffOn.mk("KB")),
     List.of(),
            led("Gate")),
    M_2_In
    (170, "2 inputs", 2,
     ModPage.InOut.ix(2),
     List.of(),
     List.of(out("OutL",Red,17,1),
             out("OutR",Red,19,1)),
     List.of(ModParam.Source_2.mk("Source"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Pad_4.mk("Pad")),
     List.of(),
            meters("L","R")),
    M_4_In
    (171, "4 inputs", 2,
     ModPage.InOut.ix(3),
     List.of(),
     List.of(out("Out1",Red,12,1),
             out("Out2",Red,14,1),
             out("Out3",Red,17,1),
             out("Out4",Red,19,1)),
     List.of(ModParam.Source_3.mk("Source"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Pad_4.mk("Pad")),
     List.of(),
            meters(namedRange("Out", 4))),
    M_DlySingleA
    (172, "Delay Static", 2,
     ModPage.Delay.ix(0),
     List.of(in("In",Red,16,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.DelayTime_3.mk("Time")),
     List.of(ModParam.DelayRange_3.mk("DelayRange"))),
    M_DlySingleB
    (173, "Delay Single", 2,
     ModPage.Delay.ix(1),
     List.of(in("In",Red,16,1),
             in("Time",Red,7,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.DelayTime_3.mk("Time"),
             ModParam.Level_100.mk("TimeMod")),
     List.of(ModParam.DelayRange_3.mk("DelayRange"))),
    M_DelayDual
    (174, "Delay Dual", 3,
     ModPage.Delay.ix(2),
     List.of(in("In",Red,19,0),
             in("Time1",Red,7,2),
             in("Time2",Red,13,2)),
     List.of(out("Out1",Red,10,2),
             out("Out2",Red,17,2)),
     List.of(ModParam.DelayTime_3.mk("Time1"),
             ModParam.Level_100.mk("Time1Mod"),
             ModParam.DelayTime_3.mk("Time2"),
             ModParam.Level_100.mk("Time2Mod")),
     List.of(ModParam.DelayRange_3.mk("DelayRange"))),
    M_DelayQuad
    (175, "Delay Quad", 5,
     ModPage.Delay.ix(3),
     List.of(in("In",Red,19,0),
             in("Time1",Red,3,4),
             in("Time2",Red,7,4),
             in("Time3",Red,11,4),
             in("Time4",Red,15,4)),
     List.of(out("OutMain",Red,19,4),
             out("Out1",Red,5,2),
             out("Out2",Red,9,2),
             out("Out3",Red,13,2),
             out("Out4",Red,17,2)),
     List.of(ModParam.DelayTime_3.mk("Time1"),
             ModParam.Level_100.mk("Time1Mod"),
             ModParam.DelayTime_3.mk("Time2"),
             ModParam.Level_100.mk("Time2Mod"),
             ModParam.DelayTime_3.mk("Time3"),
             ModParam.Level_100.mk("Time3Mod"),
             ModParam.DelayTime_3.mk("Time4"),
             ModParam.Level_100.mk("Time4Mod"),
             ModParam.TimeClk.mk("TimeClk")),
     List.of(ModParam.DelayRange_3.mk("DelayRange"))),
    M_DelayA
    (176, "Delay A", 3,
     ModPage.Delay.ix(7),
     List.of(in("In",Red,19,0)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.DelayTime_2.mk("Time"),
             ModParam.Level_100.mk("FB"),
             ModParam.Level_100.mk("Filter"),
             ModParam.Level_100.mk("DryWet"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.TimeClk.mk("TimeClk")),
     List.of(ModParam.DelayRange_2.mk("DelayRange"))),
    M_DelayB
    (177, "Delay B", 4,
     ModPage.Delay.ix(8),
     List.of(in("In",Red,19,0), // 10 <= type "Input"
             in("FBMod",Blue_red,9,3), // 15
             in("DryWetMod",Blue_red,15,3)), // 20
     List.of(out("Out",Red,19,3)), // 11 <= type "Output"
     List.of(ModParam.DelayTime_2.mk("Time"), // 6
             ModParam.Level_100.mk("FB"), // 7
             ModParam.Level_100.mk("LP"), // 19
             ModParam.Level_100.mk("DryWet"), // 8
             ModParam.TimeClk.mk("TimeClk"), // 29
             ModParam.Level_100.mk("FBMod"), // 16
             ModParam.Level_100.mk("DryWetMod"), // 6
             ModParam.ActiveMonitor.mk("Active"), // 9
             ModParam.Level_100.mk("HP")), // 5
     List.of(ModParam.DelayRange_2.mk("DelayRange"))), // 1 <= type "PartSelector"
    M_DlyClock
    (178, "Delay Clocked", 2,
     ModPage.Delay.ix(6),
     List.of(in("In",Blue_red,16,1),
             in("Clk",Yellow_orange,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Range_128.mk("Delay")),
     List.of()),
    M_DlyShiftReg
    (179, "Shift Register", 2,
     ModPage.Delay.ix(5),
     List.of(in("In",Blue_red,5,1),
             in("Clk",Yellow_orange,0,1)),
     List.of(out("Out1",Blue_red,7,1),
             out("Out2",Blue_red,9,1),
             out("Out3",Blue_red,11,1),
             out("Out4",Blue_red,12,1),
             out("Out5",Blue_red,14,1),
             out("Out6",Blue_red,15,1),
             out("Out7",Blue_red,17,1),
             out("Out8",Blue_red,19,1)),
     List.of(),
     List.of()),
    M_Operator
    (180, "FM Operator", 12,
     ModPage.Osc.ix(14),
     List.of(in("Freq",Blue,0,3),
             in("FM",Red,19,1),
             in("Gate",Yellow,0,5),
             in("Note",Blue,0,6),
             in("AMod",Blue,0,9),
             in("Vel",Blue,0,11),
             in("Pitch",Blue,0,1)),
     List.of(out("Out",Red,19,11)),
     List.of(ModParam.Kbt_1.mk("Kbt"),
             ModParam.OffOn.mk("Sync"),
             ModParam.RatioFixed.mk("RatioFixed"),
             ModParam.OpFreqCoarse.mk("FreqCoarse"),
             ModParam.OpFreqFine.mk("FreqFine"),
             ModParam.OpFreqDetune.mk("FreqDetune"),
             ModParam.OpVel.mk("Vel"),
             ModParam.OpRateScale.mk("RateScale"),
             ModParam.OpTime.mk("R1"),
             ModParam.OpLevel.mk("L1"),
             ModParam.OpTime.mk("R2"),
             ModParam.OpLevel.mk("L2"),
             ModParam.OpTime.mk("R3"),
             ModParam.OpLevel.mk("L3"),
             ModParam.OpTime.mk("R4"),
             ModParam.OpLevel.mk("L4"),
             ModParam.OpAmod.mk("AMod"),
             ModParam.OpBrPpoint.mk("BrPoint"),
             ModParam.OpDepthMode.mk("LDepthMode"),
             ModParam.OpDepth.mk("LDepth"),
             ModParam.OpDepthMode.mk("RDepthMode"),
             ModParam.OpDepth.mk("RDepth"),
             ModParam.OpLevel.mk("OutLevel"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.OffOn.mk("EnvKB")),
     List.of(),
            led("Gate")),
    M_DlyEight
    (181, "Delay 8 Tap", 3,
     ModPage.Delay.ix(4),
     List.of(in("In",Red,19,0)),
     List.of(out("Out1",Red,7,2),
             out("Out2",Red,9,2),
             out("Out3",Red,10,2),
             out("Out4",Red,12,2),
             out("Out5",Red,14,2),
             out("Out6",Red,16,2),
             out("Out7",Red,17,2),
             out("Out8",Red,19,2)),
     List.of(ModParam.DelayTime_3.mk("Time")),
     List.of(ModParam.DelayRange_3.mk("DelayRange"))),
    M_DlyStereo
    (182, "Delay Stereo", 5,
     ModPage.Delay.ix(9),
     List.of(in("In",Red,19,0)),
     List.of(out("OutL",Red,17,4),
             out("OutR",Red,19,4)),
     List.of(ModParam.DelayTime_1.mk("TimeLeft"),
             ModParam.DelayTime_1.mk("TimeRight"),
             ModParam.Level_100.mk("FBLeft"),
             ModParam.Level_100.mk("FBRight"),
             ModParam.Level_100.mk("XFBLeft"),
             ModParam.Level_100.mk("XFBRight"),
             ModParam.TimeClk.mk("TimeClk"),
             ModParam.Level_100.mk("LP"),
             ModParam.Level_100.mk("DryWet"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("HP")),
     List.of(ModParam.DelayRange_1.mk("DelayRange"))),
    M_OscPM
    (183, "Osc Phase Mod", 3,
     ModPage.Osc.ix(4),
     List.of(in("PitchVar",Blue_red,0,2),
             in("Sync",Red,12,2),
             in("PhaseMod",Red,14,2),
             in("Pitch",Blue_red,0,1)),
     List.of(out("Out",Red,19,2)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Level_100.mk("PhaseMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.Level_100.mk("PitchVar")),
     List.of(ModParam.OscWaveform_1.mk("Waveform"))),
    M_Mix1_1A
    (184, "Mixer 1-1 A", 2,
     ModPage.Mixer.ix(0),
     List.of(in("In",Blue_red,16,1),
             in("Chain",Blue_red,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.MixLevel.mk("Lev"),
             ModParam.OffOn.mk("On").label("Ch 1"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of()),
    M_Mix1_1S
    (185, "Mixer 1-1 Stereo", 2,
     ModPage.Mixer.ix(1),
     List.of(in("InL",Blue_red,14,1),
             in("InR",Blue_red,16,1),
             in("LChain",Blue_red,0,1),
             in("RChain",Blue_red,1,1)),
     List.of(out("OutL",Blue_red,17,1),
             out("OutR",Blue_red,19,1)),
     List.of(ModParam.MixLevel.mk("Lev"),
             ModParam.OffOn.mk("On").label("Ch 2"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of()),
    M_Sw1_2M
    (186, "Switch 1-2 Momentary", 2,
     ModPage.Switch.ix(6),
     List.of(in("In",Blue_red,14,1)),
     List.of(out("OutOn",Blue_red,19,1),
             out("OutOff",Blue_red,16,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.OffOn.mk("Sel").label("Switch")),
     List.of()),
    M_Sw2_1M
    (187, "Switch 2-1 Momentary", 2,
     ModPage.Switch.ix(2),
     List.of(in("InOff",Blue_red,14,1),
             in("InOn",Blue_red,16,1)),
     List.of(out("Out",Blue_red,19,1),
             out("Ctrl",Blue,0,1)),
     List.of(ModParam.OffOn.mk("Sel").label("Switch")),
     List.of()),
    M_ConstSwM
    (188, "Constant Switch Momentary", 2,
     ModPage.Level.ix(1),
     List.of(),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.LevBipUni.mk("Lev"),
             ModParam.OffOn.mk("On").label("Switch"),
             ModParam.BipUni.mk("BipUni")),
     List.of()),
    M_NoiseGate
    (189, "Noise Gate", 3,
     ModPage.Level.ix(9),
     List.of(in("In",Blue_red,19,0)),
     List.of(out("Out",Blue_red,19,2),
             out("Env",Blue,17,2)),
     List.of(ModParam.Threshold_127.mk("Threshold"),
             ModParam.NoiseGateAttack.mk("Attack"),
             ModParam.NoiseGateRelease.mk("Release"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(),
            led()),
    M_LfoB
    (190, "LFO B", 4,
     ModPage.LFO.ix(1),
     List.of(in("Rate",Blue,1,3),
             in("RateVar",Blue,3,3),
             in("Rst",Blue,0,1),
             in("Phase",Blue,10,3)),
     List.of(out("Out",Blue,19,3),
             out("Sync",Blue,0,3)),
     List.of(ModParam.LfoRate_4.mk("Rate"),
             ModParam.Level_100.mk("RateMod"),
             ModParam.LfoRange_4.mk("Range"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.LfoB_Waveform.mk("Waveform"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.Phase.mk("Phase"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.OutTypeLfo.mk("OutputType"),
             ModParam.Level_100.mk("PhaseMod")),
     List.of(),
            led()),
    M_Phaser
    (192, "Phaser", 2,
     ModPage.FX.ix(1),
     List.of(in("In",Red,16,1)),
     List.of(out("Out",Red,19,1)),
     List.of(ModParam.PhaserType.mk("Type"),
             ModParam.PhaserFreq.mk("Freq"),
             ModParam.Level_100.mk("FeedBack"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Mix4_1A
    (193, "Mixer 4-1 A", 2,
     ModPage.Mixer.ix(4),
     List.of(in("In1",Blue_red,5,1),
             in("In2",Blue_red,8,1),
             in("In3",Blue_red,11,1),
             in("In4",Blue_red,15,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(),
     List.of(),
            meter()),
    M_Mix2_1A
    (194, "Mixer 2-1 A", 2,
     ModPage.Mixer.ix(2),
     List.of(in("In1",Blue_red,9,1),
             in("In2",Blue_red,16,1),
             in("Chain",Blue_red,0,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.MixLevel.mk("Lev1"),
             ModParam.OffOn.mk("On1").label("Ch 1"),
             ModParam.MixLevel.mk("Lev2"),
             ModParam.OffOn.mk("On2").label("Ch 2"),
             ModParam.ExpLin_2.mk("ExpLin")),
     List.of()),
    M_ModAmt
    (195, "Modulation Amount", 2,
     ModPage.Level.ix(13),
     List.of(in("In",Blue_red,16,1),
             in("Mod",Blue_red,15,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.Level_100.mk("ModDepth"),
             ModParam.OffOn.mk("On").label("On"),
             ModParam.ExpLin_1.mk("ExpLin"),
             ModParam.ModAmtInvert.mk("InvertMode")),
     List.of()),
    M_OscPerc
    (196, "Osc Percussion", 3,
     ModPage.Osc.ix(11),
     List.of(in("Pitch",Blue_red,0,1),
             in("PitchVar",Blue_red,0,2),
             in("Trig",Red,3,2)),
     List.of(out("Out",Red,19,3)),
     List.of(ModParam.FreqCoarse.mk("FreqCoarse"),
             ModParam.FreqFine.mk("FreqFine"),
             ModParam.FreqMode_3.mk("FreqMode"),
             ModParam.Kbt_1.mk("Kbt"),
             ModParam.Level_100.mk("PitchMod"),
             ModParam.Level_100.mk("Decay"),
             ModParam.Level_100.mk("Click"),
             ModParam.OffOn.mk("Punch"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_Status
    (197, "Status", 2,
     ModPage.InOut.ix(8),
     List.of(),
     List.of(out("PatchActive",Yellow,8,1),
             out("VarActive",Yellow,13,1),
             out("VoiceNo",Blue,18,1)),
     List.of(),
     List.of()),
    M_PitchTrack
    (198, "Pitch Tracker", 2,
     ModPage.Note.ix(5),
     List.of(in("In",Blue_red,0,1)),
     List.of(out("Period",Yellow_orange,13,1),
             out("Gate",Yellow_orange,15,1),
             out("Pitch",Blue,19,1)),
     List.of(ModParam.Threshold_127.mk("Threshold")),
     List.of(),
            led("Gate")),
    M_MonoKey
    (199, "Monophonic Keyboard", 2,
     ModPage.InOut.ix(6),
     List.of(),
     List.of(out("Pitch",Blue,14,1),
             out("Gate",Yellow,16,1),
             out("Vel",Blue,19,1)),
     List.of(ModParam.MonoKeyMode.mk("Mode")),
     List.of()),
    M_RandomA
    (200, "Random A", 2,
     ModPage.Rnd.ix(0),
     List.of(in("Rate",Blue,0,1)),
     List.of(out("Out",Blue,19,1)),
     List.of(ModParam.LfoRate_3.mk("Rate"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.BipPosNeg.mk("OutputType"),
             ModParam.LfoRange_3.mk("Range"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.RndEdge.mk("Edge"),
             ModParam.RandomAStepProb.mk("StepProb")),
     List.of(),
            led()),
    M_RandomB
    (202, "Random B", 3,
     ModPage.Rnd.ix(1),
     List.of(in("Rate",Blue,0,1),
             in("RateVar",Blue,0,2)),
     List.of(out("Out",Blue,19,2)),
     List.of(ModParam.LfoRate_3.mk("Rate"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.Kbt_4.mk("Kbt"),
             ModParam.Level_100.mk("RateMod"),
             ModParam.Level_100.mk("StepProb"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.BipPosNeg.mk("OutputType"),
             ModParam.LfoRange_3.mk("Range"),
             ModParam.RndEdge.mk("Edge")),
     List.of(),
            led()),
    M_RndClkA
    (204, "Random Clock A", 2,
     ModPage.Rnd.ix(2),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,4,1),
             in("Seed",Blue_red,7,1)),
     List.of(out("Out",Blue_red,19,1)),
     List.of(ModParam.RndProb.mk("StepProb"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.OffOn.mk("Dice"),
             ModParam.BipPosNeg.mk("OutputType"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of()),
    M_RndTrig
    (205, "Random Trig", 2,
     ModPage.Rnd.ix(4),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,4,1),
             in("Seed",Blue_red,7,1),
             in("Prob",Blue_red,8,1)),
     List.of(out("Out",Yellow_orange,19,1)),
     List.of(ModParam.RndProb.mk("StepProb"),
             ModParam.Level_100.mk("StepProbMod"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.PolyMono.mk("PolyMono")),
     List.of()),
    M_RndClkB
    (206, "Random Clock B", 3,
     ModPage.Rnd.ix(3),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,0,2),
             in("Seed",Blue_red,3,2),
             in("Step",Blue,11,2)),
     List.of(out("Out",Blue_red,19,2)),
     List.of(ModParam.RndProb.mk("StepProb"),
             ModParam.BipPosNeg.mk("OutputType"),
             ModParam.ActiveMonitor.mk("Active"),
             ModParam.PolyMono.mk("PolyMono"),
             ModParam.Level_100.mk("StepProbMod")),
     List.of(ModParam.Rnd_1.mk("Character"))),
    M_RndPattern
    (208, "Random Pattern", 3,
     ModPage.Rnd.ix(5),
     List.of(in("Clk",Yellow_orange,0,1),
             in("Rst",Yellow_orange,0,2),
             in("A",Blue,3,1),
             in("B",Blue,3,2),
             in("StepProb",Blue,9,2)),
     List.of(out("Out",Blue_red,19,2)),
     List.of(ModParam.RangeBip_128.mk("PatternA"),
             ModParam.Level_100.mk("PatternB"),
             ModParam.RndProb.mk("StepProb"),
             ModParam.Range_128.mk("LoopCount"),
             ModParam.Level_100.mk("StepProbMod"),
             ModParam.BipPosNeg.mk("OutputType"),
             ModParam.ActiveMonitor.mk("Active")),
     List.of(ModParam.RndStepPulse.mk("Waveform")));



    public final int ix;
    public final int height;
    public final String longName;
    public final ModPageIx modPageIx;
    public final List<Connector> inPorts;
    public final List<Connector> outPorts;
    private final List<NamedParam> params;
    public final List<NamedParam> modes;
    public final String shortName;
    private final Map<VisualType,List<Visual>> visuals;

    ModuleType(int ix,
               String longName,
               int height,
               ModPageIx modPageIx,
               List<Connector> inPorts,
               List<Connector> outPorts,
               List<NamedParam> params,
               List<NamedParam> modes) {
        this(ix
        ,longName
        ,height
        ,modPageIx
        ,inPorts
        ,outPorts
        ,params
        ,modes
        ,Map.of(Led,List.of(),Meter,List.of()));
    }

    ModuleType(int ix,
               String longName,
               int height,
               ModPageIx modPageIx,
               List<Connector> inPorts,
               List<Connector> outPorts,
               List<NamedParam> params,
               List<NamedParam> modes,
               Map<VisualType,List<Visual>> visuals) {
        this.ix = ix;
        this.height = height;
        this.longName = longName;
        this.modPageIx = modPageIx;
        this.inPorts = inPorts;
        this.outPorts = outPorts;
        this.params = params;
        this.modes = modes;
        this.shortName = mkShortName(name());
        this.visuals = validateVisuals(visuals);
        Arrays.stream(VisualType.values()).forEach(t ->
                ModuleType.this.visuals.computeIfAbsent(t,k->List.of()));
    }

    private static HashMap<VisualType, List<Visual>> validateVisuals(Map<VisualType, List<Visual>> visuals) {
        HashMap<VisualType, List<Visual>> m = new HashMap<>();
        Set<List<String>> names = new HashSet<>();
        for (VisualType vt : VisualType.values()) {
            List<Visual> vs = visuals.get(vt);
            if (vs == null) {
                m.put(vt, List.of());
            } else {
                vs.forEach(v -> {

                });
                m.put(vt, Streams.mapWithIndex(vs.stream(),(v,i) -> {
                    if (!names.add(v.names())) {
                        throw new IllegalStateException("Duplicate name for visual: " + v);
                    }
                    return v.setIndex((int)i);
                }).toList());
            }
        }
        return m;
    }


    private static String mkShortName(String name) {
        return name.substring(2).replace('_','-').replace("-and-","&");
    }

    public List<NamedParam> getParams() {
        return params;
    }

    public Map<VisualType, List<Visual>> getVisuals() {
        return visuals;
    }

    public record ModPageIx(ModPage page, Integer ix) implements Comparable<ModPageIx> {

        @Override
        public int compareTo(ModPageIx o) {
            int c = page.compareTo(o.page);
            if (c != 0) { return c; } else { return ix.compareTo(o.ix); }
        }
    }

    public enum ModPage {
        InOut,
        Note,
        Osc,
        LFO,
        Rnd,
        Env,
        Filter,
        FX,
        Delay,
        Shaper,
        Level,
        Mixer,
        Switch,
        Logic,
        Seq,
        MIDI;

        public ModPageIx ix(int i) {
            return new ModPageIx(this,i);
        }
    }

    public static final Map<Integer,ModuleType> BY_ID = mkById();

    private static Map<Integer, ModuleType> mkById() {
        Map<Integer, ModuleType> m = new TreeMap<>();
        for (ModuleType t : ModuleType.values()) {
            m.put(t.ix,t);
        }
        return m;
    }

    public static final Map<ModPage,List<ModuleType>> BY_PAGE = mkByPage();

    private static Map<ModPage, List<ModuleType>> mkByPage() {
        Map<ModPage, List<ModuleType>> m = new TreeMap<>();
        Stream.of(ModuleType.values()).forEach(mt -> {
            m.compute(mt.modPageIx.page(),(mp, l) -> {
                if (l == null) { l = new ArrayList<>(); }
                l.add(mt);
                return l;
            });
        });
        m.values().forEach(l ->
                l.sort(Comparator.comparingInt(mt -> mt.modPageIx.ix)));
        return m;
    }

    public static ModuleType getById(int id) {
        ModuleType m = BY_ID.get(id);
        if (m == null) {
            throw new IllegalArgumentException("Invalid module id: " + id);
        }
        return m;
    }


    private static Map<VisualType, List<Visual>> meter() {
        return meters(VisualType.Meter.name());
    }

    private static Map<VisualType,List<Visual>> meters(String... names) {
        return Map.of(VisualType.Meter, Arrays.stream(names).map(n ->
                new Visual(VisualType.Meter,List.of(n))).toList());
    }

    private static Map<VisualType,List<Visual>> ledgroup(Visual.LedGroupType groupType, int names) {
        return ledgroup(groupType, namedRange("",names));
    }
    private static Map<VisualType,List<Visual>> ledgroup(Visual.LedGroupType groupType, String... names) {
        return Map.of(LedGroup,List.of(new Visual(LedGroup,groupType,List.of(names),0)));
    }

    private static Map<VisualType, List<Visual>> led() {
        return led("On");
    }
    private static Map<VisualType, List<Visual>> led(String name) {
        return Map.of(Led,List.of(new Visual(Led,List.of(name))));
    }

    private static Map<VisualType,List<Visual>> visuals(
            Map<VisualType, List<Visual>> v1s,
            Map<VisualType, List<Visual>> v2s) {
        HashMap<VisualType, List<Visual>> m = new HashMap<>(v1s);
        for (Map.Entry<VisualType, List<Visual>> e : v2s.entrySet()) {
            List<Visual> l = m.get(e.getKey());
            if (l == null) {
                m.put(e.getKey(),e.getValue());
            } else {
                ArrayList<Visual> lm = new ArrayList<>(l);
                lm.addAll(e.getValue());
                m.put(e.getKey(),lm);
            }
        }
        return m;
    }

    private static String[] namedRange(String prefix, int count) {
        return IntStream.range(0, count).boxed().map(i -> prefix + i)
                .toList().toArray(new String[count]);
    }
}
